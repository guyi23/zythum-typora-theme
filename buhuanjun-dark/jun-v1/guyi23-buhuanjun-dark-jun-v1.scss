/* 
 - @Theme guyi23-buhuanjun-dark-red-v1
 - @Author buhuan
 - @Website https://www.buhuanjun.com
 */

:root {
  /* 
   * 颜色值 
   */
  --color-primary: rgba(126, 127, 128, 1);

  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);

  --color-r62-g62-b62-a100: rgba(62, 62, 62, 100%);
  --color-r232-g17-b35-a100: rgba(126, 127, 128, 100%);
  --color-r31-g31-b31-a100: rgba(31, 31, 31, 100%);

  --color-r24-g24-b24-a100: rgba(24, 24, 24, 100%);

  --color-r23-g23-b23-a100: rgba(23, 23, 23, 100%);
  --color-r94-g94-b94-a100: rgba(62, 62, 62, 100%);

  --color-r09-g09-b09-a100: rgba(09, 09, 09, 100%);

  /* 
   * 背景色 
   */
  --bg-color-primary: var(--color-primary);

  --bg-color-frame: var(--color-r24-g24-b24-a100);

  --bg-color-sidebar: var(--color-r24-g24-b24-a100);

  --bg-color-content: var(--color-black);

  --bg-color-button: var(--color-r62-g62-b62-a100);

  --bg-color-search-result-more: var(--color-r62-g62-b62-a100);

  --bg-color-active: var(--color-r09-g09-b09-a100);

  --bg-color-search-result-item-active: var(--color-r09-g09-b09-a100);

  --bg-color-sidebar-item-active: var(--color-r09-g09-b09-a100);

  --bg-color-outline-item-active: var(--color-r09-g09-b09-a100);

  --bg-color-hover: var(--color-r94-g94-b94-a100);

  --bg-color-hover-primary: var(--color-primary);

  --bg-color-hover-window-close: var(--color-r232-g17-b35-a100);

  --bg-color-blockquote: var(--color-r24-g24-b24-a100);

  --bg-color-md-fences: var(--color-r24-g24-b24-a100);

  --bg-color-title: var(--color-r24-g24-b24-a100);

  --bg-color-title-trans: linear-gradient(
    to right,
    var(--color-r09-g09-b09-a100),
    var(--color-r94-g94-b94-a100)
  );

  --bg-color-title-selection: var(--color-primary);

  --bg-color-context-menu: var(--color-r31-g31-b31-a100);

  /* 
   * 边框颜色 
   */
  --border-color: var(--color-r62-g62-b62-a100);
  --border-color-primary: var(--color-primary);
  --border-color-header: var(--color-r62-g62-b62-a100);
  --border-color-footer: var(--color-r62-g62-b62-a100);
  --border-color-sidebar: var(--color-r62-g62-b62-a100);
  --border-color-white: var(--color-white);
  --border-color-title-trans: linear-gradient(
    to right,
    var(--color-primary),
    var(--color-r94-g94-b94-a100)
  );

  /* 字体 */
  --typeface: "Consolas", "Courier New";

  /* 字大小 */
  --font-size: 1.4rem;

  /* 字颜色 */
  --color-text: var(--color-white);
  --color-text-primary: var(--color-primary);
}

* {
  font-family: var(--typeface);
  &::selection {
    background-color: var(--color-primary) !important;
  }
  button {
    &:focus,
    &:active {
      outline: none !important;
    }
  }
}

html,
body {
  padding: 0;
  margin: 0;
  border: none;
  overflow: hidden;
  border-radius: 0;

  font-family: var(--typeface) !important;
  font-size: var(--font-size);
  color: var(--color-text);

  word-break: break-all;
  letter-spacing: 0;

  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: subpixel-antialiased;
  background-color: var(--bg-color-frame);
}

/* 窗体: 头部 */
header {
  height: 3.2rem;
  font-family: var(--typeface);
  background-color: var(--bg-color-frame);
  border-bottom: 0.1rem solid var(--border-color-header);
  overflow: hidden;
  #top-titlebar {
    height: 100%;
    display: flex;
    align-items: center;
    #w-titlebar-left {
      flex: 1;
      height: 100%;
      display: flex;
      align-items: center;
      max-width: unset;
      overflow: hidden;
      padding: 0 0.8rem;
      #w-menu-btn {
        flex-shrink: 0;
        margin: 0;
        .ty-menu-btn-area {
          width: 2.4rem;
          height: 2.4rem;
          display: flex;
          flex-direction: column;
          align-items: flex-start;
          justify-content: space-evenly;
          padding-left: 0.5rem;
          border-radius: 0.1rem;
          &:hover {
            cursor: pointer;
            background-color: var(--bg-color-hover);
          }
          .ty-menu-btn-area-sub {
            color: var(--color-text);
            position: unset;
          }
        }
      }
      #title-text {
        color: var(--color-text);
        padding: 0;
        opacity: 1;
        position: relative;
        margin-left: 0.4rem;
        position: relative;
        top: -0.1rem;
        left: 0;
        flex: 1;
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        display: unset;
        font-size: 1.2rem;
        &.title-modified {
          color: var(--color-primary);
          &::after {
            display: none;
          }
        }
      }
    }

    #w-traffic-lights {
      display: flex;
      align-items: center;
      flex-shrink: 0;
      height: 100%;
      #w-min {
        width: 2.4rem;
        height: 2.4rem;
        margin: 0;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--color-text);
        border: none;
        margin-right: 0.4rem;
        border-radius: 0.1rem;
        &:hover {
          background-color: var(--bg-color-hover);
          cursor: pointer;
        }
      }

      #w-max-group {
        #w-max {
          width: 2.4rem;
          height: 2.4rem;
          color: var(--color-text);
          margin: 0;
          padding: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          color: var(--color-text);
          border: none;
          margin-right: 0.4rem;
          border-radius: 0.1rem;
          &:hover {
            background-color: var(--bg-color-hover);
            cursor: pointer;
          }
        }

        #w-pin,
        #w-full {
          display: none;
        }
      }

      #w-unpin {
        display: none;
      }

      #w-restore {
        width: 2.4rem;
        height: 2.4rem;
        margin: 0;
        padding: 0;
        text-align: center;
        color: var(--color-text);
        border: none;
        margin-right: 0.4rem;
        border-radius: 0.1rem;
        position: relative;
        .ty-icon {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
        &:hover {
          background-color: var(--bg-color-hover);
          cursor: pointer;
        }
      }

      #w-close {
        width: 2.4rem;
        height: 2.4rem;
        margin: 0;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--color-text);
        border: none;
        margin-right: 0.8rem;
        border-radius: 0.1rem;
        &:hover {
          background-color: var(--bg-color-hover-window-close);
          cursor: pointer;
        }
      }
    }

    #w-top-margin {
      display: none;
    }
  }
}

/* 窗体: 底部 */
footer {
  font-family: var(--typeface);
  background-color: var(--bg-color-frame) !important;
  right: 0 !important;
  height: 3.2rem !important;
  padding: 0 !important;
  display: flex !important;
  align-items: center !important;
  &.ty-footer {
    border-top: 0.1rem solid var(--border-color-footer) !important;
  }
  #outline-btn-wrapper {
    width: 2.4rem;
    height: 2.4rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.1rem;
    margin-left: 0.8rem;
    transform: translateY(-0.1rem);
    &:hover {
      background-color: var(--bg-color-hover);
      #outline-btn {
        color: var(--color-white);
      }
    }
  }
  #toggle-sourceview-btn {
    width: 2.4rem;
    height: 2.4rem;
    display: flex !important;
    align-items: center;
    justify-content: center;
    border-radius: 0.1rem;
    margin-left: 0.4rem;
    transform: translateY(-0.1rem);
    &:hover {
      background-color: var(--bg-color-hover);
    }
  }
  #footer-spell-check {
    padding: 0;
    width: 2.4rem;
    height: 2.4rem;
    display: none !important;
    align-items: center;
    justify-content: center;
    border-radius: 0.1rem;
    position: absolute;
    margin: 0;
    top: 50%;
    transform: translateY(calc(-50% - 0.1rem));
    right: 0.8rem;
    &:hover {
      background-color: var(--bg-color-hover);
    }
    opacity: 1;
  }

  #footer-word-count {
    opacity: 1;
    padding: 0;
    height: 2.4rem;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 0.8rem;
    border-radius: 0.1rem;
    position: absolute;
    top: 50%;
    transform: translateY(calc(-50% - 0.1rem));
    right: 0.8rem;
    margin: 0;
    &:hover {
      background-color: var(--bg-color-hover);
    }
    .ty-word-count-expand {
      opacity: 1;
    }
  }
}

.ty-show-word-count #footer-word-count {
  background-color: var(--bg-color-primary);
}

.typora-sourceview-on {
  #outline-btn-wrapper {
    display: none;
  }
  #toggle-sourceview-btn {
    width: unset;
    background: transparent;
    margin-left: 0.8rem;
    border-radius: 0.1rem;
    &:hover {
      background-color: var(--bg-color-hover);
    }
    .fa.fa-code {
      margin-right: 0.4rem;
    }
    span {
      line-height: 2.4rem;
    }
  }
}

@media (min-width: 1270px) {
  .pin-outline footer.ty-footer {
    border-top: 0.1rem solid var(--border-color-footer) !important;
  }
}

/* 侧边栏 */
#typora-sidebar {
  background-color: var(--bg-color-sidebar);
  border-right: 0.1rem solid var(--border-color-sidebar);

  &.active-tab-files {
    .info-panel-tab-wrapper.ty-tab-wrapper {
      #info-panel-tab-file {
        .info-panel-tab-title {
          font-weight: bolder;
          color: var(--color-primary);
        }
        .info-panel-tab-border {
          background-color: var(--bg-color-primary);
        }
      }
    }
    #sidebar-content {
      bottom: 3.2rem;
    }
  }

  &.active-tab-outline {
    .info-panel-tab-wrapper.ty-tab-wrapper {
      #info-panel-tab-outline {
        .info-panel-tab-title {
          font-weight: bolder;
          color: var(--color-primary);
        }
        .info-panel-tab-border {
          background-color: var(--bg-color-primary);
        }
      }
    }
    #ty-sidebar-footer {
      display: none !important;
    }
  }

  &.ty-show-search {
    .info-panel-tab-wrapper.ty-tab-wrapper {
      #info-panel-tab-search {
        .info-panel-tab-title {
          font-weight: bolder;
          color: var(--color-primary);
        }
        .info-panel-tab-border {
          background-color: var(--bg-color-primary);
        }
      }
    }
    #sidebar-content {
      #file-library-search {
        min-height: 4.2rem;
        height: unset;
        #file-library-search-panel {
          padding: 0.8rem;
          border-bottom: 0.1rem solid var(--border-color);
          #file-library-search-input {
            height: 2.4rem;
            padding: 0 9.2rem 0 0.8rem;
            border: 0.1rem solid var(--border-color-primary);
            background-color: transparent;
            color: var(--color-white);
            &::selection {
              background-color: var(--color-primary);
            }
          }
          .searchpanel-search-option-btn {
            top: 50%;
            transform: translateY(-50%);
            display: block !important;
            background-color: var(--bg-color-button);
            margin: 0;
            padding: 0;
            width: 2.4rem;
            height: 1.6rem;
            display: flex !important;
            align-items: center;
            justify-content: center;
            border-radius: 0.1rem;
            &.select {
              color: var(--color-white);
              background-color: var(--color-primary);
            }
            &#filesearch-regexp-option-btn {
              right: 1.6rem;
            }
            &#filesearch-word-option-btn {
              right: 4.4rem;
            }
            &#filesearch-case-option-btn {
              right: 7.2rem;
            }
          }
        }
        #file-library-search-result {
          padding-bottom: 0;
          &::-webkit-scrollbar {
            width: 0;
          }
          .ty-search-item {
            padding: 0.8rem 0;
            border-bottom: 0.1rem solid var(--border-color);
            &.active {
              background-color: var(--bg-color-search-result-item-active);
            }
            .ty-search-item-summary {
              padding-top: 0;
              font-family: var(--typeface);
              .ty-search-item-collapse-icon {
                opacity: 1;
              }
              .file-list-item-file-name {
                font-size: 1.4rem;
                line-height: 2rem;
                display: flex;
                align-items: center;
                overflow: hidden;
                padding-right: 0.8rem;
                .file-list-item-file-name-part {
                  overflow: hidden;
                  text-overflow: ellipsis;
                  white-space: nowrap;
                }
                .file-list-item-file-ext-part {
                  flex-shrink: 0;
                  opacity: 1;
                }
              }
              .file-list-item-right {
                flex-shrink: 0;
                .file-list-item-count {
                  background-color: var(--bg-color-button);
                  color: var(--color-white);
                  padding: 0 0.4rem;
                  margin: 0 0.8rem 0 0;
                  font-size: 1.2rem;
                  border-radius: 0.1rem;
                  height: 2rem;
                  min-width: 2rem;
                  text-align: center;
                  line-height: 2rem;
                }
              }
              .file-list-item-parent-loc {
                line-height: 1.8rem;
                font-size: 1.2rem;
                width: 100%;
                padding-right: 0.8rem;
              }
            }
            .ty-search-item-matches {
              padding-bottom: 0;
              .ty-search-item-line {
                font-size: 1.2rem;
                line-height: 1.8rem;
                word-break: break-all;
                white-space: pre-wrap;
                padding: 0.4rem 0.8rem 0.4rem 2.4rem;
                font-family: var(--typeface);
                &.active {
                  background-color: var(--bg-color-sidebar-item-active);
                }
                &:hover {
                  background-color: var(--bg-color-primary);
                  .ty-file-search-match-text {
                    background-color: var(--bg-color-button);
                  }
                }
                &.ty-search-item-line-expand {
                  &:hover {
                    background-color: var(--bg-color-search-result-more);
                    font-weight: bolder;
                  }
                }
                .ty-file-search-match-text {
                  background-color: var(--bg-color-primary);
                  border-radius: 0.1rem;
                  color: var(--color-white);
                  font-weight: bold;
                  padding: 0 0.1rem;
                }
              }
            }
          }
        }
      }
    }
  }

  &.ty-show-outline-filter {
    #sidebar-content {
      #file-library-search {
        min-height: 4.2rem;
        height: unset;
        #file-library-search-panel {
          padding: 0.8rem;
          border-bottom: 0.1rem solid var(--border-color);
          #file-library-search-input {
            width: 100% !important;
            height: 2.4rem;
            padding: 0 0.8rem;
            border: 0.1rem solid var(--border-color-primary);
            background-color: transparent;
            color: var(--color-white);
            &::selection {
              background-color: var(--color-primary);
            }
          }
          #close-outline-filter-btn {
            display: none;
          }
        }
      }
    }
  }

  .ty-tab-wrapper {
    background-color: var(--bg-color-frame);
    height: 3.2rem;
    margin-top: 0;
    border-bottom: 0.1rem solid var(--border-color-header);
    .info-panel-tab {
      margin-top: 0;
      height: 100%;
      position: relative;
      padding: 0;
      width: unset;
      font-weight: unset !important;
      padding-top: 0.4rem;
      .info-panel-tab-title {
        padding-bottom: 0;
        height: 2.4rem;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 0.8rem;
        border-radius: 0.1rem;
        &:hover {
          background-color: var(--bg-color-hover-primary);
          color: var(--color-white) !important;
        }
      }
      .info-panel-tab-border {
        height: 0.1rem !important;
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translate(-50%, 100%);
        width: 100%;
      }
    }
  }

  #sidebar-content {
    top: 3.2rem;
    #file-library {
      padding: 0 0.1rem 0 0;
      overflow: hidden;
      overflow-y: auto;
      &::-webkit-scrollbar {
        width: 0;
      }
      #file-library-tree {
        display: block;
        padding: 0;
        &::after {
          opacity: 1 !important;
        }
        .file-library-node {
          &.active {
            .file-node-background {
              background-color: var(--bg-color-sidebar-item-active);
              height: 3rem;
              width: calc(100% + 0.1rem);
              border-left: 0.4rem solid var(--color-primary);
            }
            .file-node-content {
              .file-node-icon {
                color: var(--color-primary);
              }
              .file-node-title {
                .file-node-title-name-part,
                .file-node-title-ext-part {
                  color: var(--color-primary);
                }
              }
            }
          }
          &.blink-area {
            animation: unset;
          }
          .file-node-content {
            display: flex;
            align-items: center;
            position: relative;
            padding-right: 0.8rem;
            padding-bottom: 0.4rem;
            .file-node-open-state {
              margin-right: 0.4rem;
              .fa-caret-right,
              .fa-caret-down {
                color: var(--color-white);
              }
            }
            .file-node-icon {
              margin-right: 0.4rem;
              color: var(--color-white);
            }
            .file-node-title {
              display: flex;
              align-items: center;
              color: var(--color-white);
              .file-node-title-name-part {
                display: block;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
              }
              .file-node-title-ext-part {
                display: block;
                flex-shrink: 0;
              }
            }
            .file-tree-rename-div {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 2.8rem;
              right: 0.3rem;
              transform: translateY(0.3rem);
              .file-tree-rename-input {
                width: 100% !important;
                padding-right: 0.4rem;
                border: 0.1rem solid var(--color-primary);
                background-color: var(--bg-color-sidebar);
                color: var(--color-white);
                &::selection {
                  background-color: var(--color-primary);
                }
              }
            }
          }
        }
      }
    }

    #outline-content {
      padding: 0;
      &::-webkit-scrollbar {
        width: 0;
      }
      &::after {
        opacity: 1 !important;
        color: var(--color-white);
      }
      .outline-item-wrapper {
        &.outline-h1 {
          > .outline-item {
            padding-left: 0;
            .outline-expander,
            .outline-label {
              font-weight: bolder !important;
            }
          }
        }
        &.outline-h2 {
          .outline-item {
            padding-left: 1.2rem;
          }
        }
        &.outline-h3 {
          .outline-item {
            padding-left: 2.4rem;
          }
        }
        &.outline-h4 {
          .outline-item {
            padding-left: 3.6rem;
          }
        }
        &.outline-h5 {
          .outline-item {
            padding-left: 4.8rem;
          }
        }
        &.outline-h6 {
          .outline-item {
            padding-left: 6rem;
          }
        }
        .outline-item {
          font-size: 1.4rem;
          line-height: 3rem;
          display: flex;
          align-items: center;
          padding: 0;
          &:hover {
            text-decoration: none;
            background-color: var(--bg-color-hover);
          }
          &.outline-item-active {
            background-color: var(--bg-color-outline-item-active);
            position: relative;
            &::before {
              content: "";
              width: 0.2rem;
              height: 100%;
              position: absolute;
              top: 0;
              left: 0;
              background-color: var(--bg-color-primary);
            }
            .outline-expander {
              color: var(--color-primary);
            }
            .outline-label.outline-active {
              font-weight: normal;
              color: var(--color-primary);
            }
          }
          .outline-expander {
            padding: 0;
            width: 2.4rem;
            height: 2.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            &::before {
              font-size: 1.2rem;
            }
          }
          .outline-label {
            flex: 1;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            text-decoration: none !important;
            .ty-outline-hit {
              color: var(--color-primary);
            }
          }
        }
      }
    }
  }

  #ty-sidebar-footer {
    height: 3.2rem;
    border-top: 0.1rem solid var(--border-color-footer);
    background-color: var(--bg-color-frame);
    display: block !important;
    opacity: 1 !important;
    & > div {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      column-gap: 0.4rem;
      padding: 0 0.8rem;
      &:hover {
        align-items: center !important;
      }
      .sidebar-footer-item {
        line-height: 2.3rem;
        opacity: 1;
      }
      #sidebar-new-file-btn {
        width: 2.4rem;
        height: 2.4rem;
        display: none !important;
        align-items: center;
        justify-content: center;
        margin: 0;
        padding: 0;
        border-radius: 0.1rem;
        &:hover {
          background-color: var(--bg-color-hover);
        }
        .ty-icon.ty-add {
          top: 0;
        }
      }
      #sidebar-menu-btn {
        height: 2.3rem;
        border-radius: 0.1rem;
        &:hover {
          background-color: var(--bg-color-hover) !important;
        }
        .sidebar-footer-item {
          padding: 0;
          background-color: transparent;
          .sidebar-footer-main-item-label {
            line-height: unset;
            opacity: 1;
          }
        }
      }
      #switch-file-list-btn {
        padding: 0;
        margin: 0;
        width: 2.4rem;
        height: 2.4rem;
        border-radius: 0.1rem;
        display: none !important;
        align-items: center;
        justify-content: center;
        &:hover {
          background-color: var(--bg-color-hover) !important;
        }
      }
    }
  }
}

content {
  top: 3.2rem !important;
  bottom: 3.2rem !important;
  left: 0;
  right: 0;
  padding: 0 1.2rem;

  overflow: hidden;
  overflow-y: auto;

  background-color: var(--bg-color-content);

  background-image: linear-gradient(
      90deg,
      var(--color-r23-g23-b23-a100) 0.1rem,
      transparent 0
    ),
    linear-gradient(1turn, var(--color-r23-g23-b23-a100) 0.1rem, transparent 0);
  background-size: 2.4rem 2.4rem;
  background-position: 50% 50%;

  &::-webkit-scrollbar {
    width: 0;
  }

  #write {
    overflow: hidden;
    min-height: 100% !important;
    padding: 0;
    margin: 0 auto;
    background-color: transparent;
    /* H1 ~ H6 */
    h1, h2, h3, h4, h5, h6 {
      .md-plain {
        &::selection {
          background: var(--bg-color-title-selection) !important;
          color: var(--color-white);
        }
      }
    }
    h1 {
      color: var(--color-primary);
      font-family: var(--typeface);
      font-weight: bolder;
      font-size: 2.4rem !important;
      line-height: 4.8rem !important;
      margin: 1.2rem 0;

      display: flex;
      align-items: center;
      justify-content: center;

      .md-plain {
        display: block;
        background-image: var(--bg-color-title-trans);
        padding: 0 4.8rem;
        position: relative;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        border: 0.1rem solid var(--border-color-primary);
        border-radius: 0.1rem;

        &::before {
          content: "~";
          width: 4.8rem;
          height: 4.8rem;
          position: absolute;
          left: 0;
          top: 50%;
          transform: translateY(-50%);
          display: flex;
          align-items: center;
          justify-content: center;
        }

        &::after {
          content: "~";
          width: 4.8rem;
          height: 4.8rem;
          position: absolute;
          right: 0;
          top: 50%;
          transform: translateY(-50%);
          display: flex;
          align-items: center;
          justify-content: center;
        }
      }
    }

    h2 {
      color: var(--color-primary);
      font-size: 2.2rem;
      line-height: 3.6rem;
      font-style: italic;
      margin: 1.2rem 0;
      font-weight: bold;

      display: flex;
      align-items: center;
      justify-content: flex-start;

      &::after {
        content: "";
        height: 0.1rem;
        background-image: var(--border-color-title-trans);
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
      }

      .md-plain {
        display: block;
        background-image: var(--bg-color-title-trans);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 1.2rem 0 2.4rem;
        position: relative;
        text-align: center;
        border: 0.1rem solid var(--border-color-primary);
        border-radius: 0.1rem 0.1rem 0 0;

        &::before {
          content: "@";
          width: 2.4rem;
          height: 2.4rem;
          position: absolute;
          left: 0;
          top: 50%;
          transform: translateY(-50%);
          font-style: italic;
          display: flex;
          align-items: center;
          justify-content: center;
        }
      }
    }

    h3 {
      color: var(--color-primary);
      font-size: 1.8rem;
      line-height: 3rem;
      margin: 1.2rem 0;

      display: flex;
      align-items: center;
      justify-content: flex-start;

      &::before {
        content: "";
        display: none;
      }

      .md-plain {
        display: block;
        background-image: var(--bg-color-title-trans);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 1.2rem 0 2.4rem;
        position: relative;
        text-align: center;
        border-radius: 0.2rem;
        border: 0.1rem solid var(--border-color-primary);

        &::before {
          content: "#";
          width: 2.4rem;
          height: 2.4rem;
          position: absolute;
          left: 0;
          top: 50%;
          bottom: 0;
          transform: translateY(-50%);
          display: flex;
          align-items: center;
          justify-content: center;
        }
      }
    }

    h4 {
      color: var(--color-primary);
      font-size: 1.4rem;
      line-height: 2.2rem;
      margin: 1.2rem 0;

      display: flex;
      align-items: center;
      justify-content: flex-start;

      &::before {
        content: "";
        display: none;
      }

      .md-plain {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 1.2rem 0 2.4rem;
        position: relative;
        text-align: center;
        border-radius: 0.2rem;
        border: 0.1rem solid var(--border-color);
        background-color: var(--bg-color-title);
        font-style: normal;

        &::before {
          content: "$";
          width: 2.4rem;
          height: 2.4rem;
          position: absolute;
          left: 0;
          top: 50%;
          bottom: 0;
          transform: translateY(-50%);
          display: flex;
          align-items: center;
          justify-content: center;
          font-style: normal;
        }
      }
    }

    h5 {
      color: var(--color-primary);
      font-size: 1.2rem;
      line-height: 1.8rem;
      margin: 1.2rem 0;

      display: flex;
      align-items: center;
      justify-content: flex-start;

      &::before {
        content: "";
        display: none;
      }

      .md-plain {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 1.2rem 0 2.4rem;
        position: relative;
        text-align: center;
        background-color: var(--bg-color-title);
        border: 0.1rem solid var(--border-color);

        &::before {
          content: "&";
          width: 2.4rem;
          height: 1.8rem;
          position: absolute;
          left: 0;
          top: 50%;
          bottom: 0;
          transform: translateY(-50%);
          display: flex;
          align-items: center;
          justify-content: center;
        }
      }
    }

    h6 {
      color: var(--color-primary);
      font-size: 1.2rem;
      line-height: 1.6rem;
      margin: 1.2rem 0;

      display: flex;
      align-items: center;
      justify-content: flex-start;

      &::before {
        content: "";
        display: none;
      }

      .md-plain {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 1.2rem 0 2.4rem;
        position: relative;
        text-align: center;
        background-color: var(--bg-color-title);
        border: 0.1rem solid var(--border-color);
        font-style: normal;

        &::before {
          content: "*";
          width: 2.4rem;
          height: 1.6rem;
          position: absolute;
          left: 0;
          top: 55%;
          bottom: 0;
          text-align: center;
          transform: translateY(-50%);
          display: flex;
          align-items: center;
          justify-content: center;
          font-style: normal;
        }
      }
    }

    /* blockquote */
    blockquote {
      background-color: var(--bg-color-blockquote);
      padding: 0.4rem 0.4rem 0.4rem 0.6rem;
      margin: 0;
      border: 0.1rem solid var(--border-color);
      border-left: 0.2rem solid var(--border-color-primary);
      border-radius: 0.2rem;
      .md-end-block {
        margin: 0;
        font-size: 1.4rem;
        line-height: 2.2rem;
      }
    }

    /* 代码块 */
    .md-fences {
      padding: 0.4rem 0.8rem;
      margin: 0;
      background-color: var(--bg-color-md-fences);
      font-size: 1.2rem !important;
      line-height: 2.4rem !important;
      border-radius: 0.1rem;
      border: 0.1rem solid var(--border-color);
      pre.CodeMirror-line {
        padding: 0;
        word-break: break-all;
        .CodeMirror-selectedtext {
          background: var(--bg-color-primary) !important;
          display: inline-block;
          font-size: 1.2rem !important;
          line-height: 2.4rem !important;
        }
        .cm-variable {
          color: var(--color-white);
        }
      }
      .CodeMirror-cursors {
        .CodeMirror-cursor {
          transform: scale(0.5);
          border-left: 0.2rem solid var(--border-color-white) !important;
        }
      }
    }

    /* 列表 */
    ul.ul-list {
      margin: 0;
      padding-left: 2.4rem;
      li.md-list-item {
        p.md-end-block {
          margin: 0.4rem 0;
          .md-plain {
            font-size: 1.4rem;
            line-height: 2.2rem;
          }
        }
      }
    }

    /* 段落 */
    p.md-end-block.md-p {
      margin: 0 !important;
      font-size: 1.4rem;
      line-height: 2.4rem;
    }

    // 间隔行, 高1.2rem.
    span.md-br {
      height: 1.2rem;
      display: block;
      width: 100%;
      background-color: transparent;
    }
  }
}

/*
 * context-menu
 */
#context-menu {
  background-color: var(--bg-color-context-menu);
  border: 0.1rem solid var(--border-color);
  padding: 0.4rem 0;
  li {
    &.active {
      a {
        background-color: var(--bg-color-hover);
      }
    }
    a {
      padding: 0 2.4rem;
      font-size: 1.2rem;
      height: 3rem;
      line-height: 3rem;
      &:hover {
        cursor: pointer;
        background-color: var(--bg-color-hover);
      }
      span {
        line-height: 3rem;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        padding-right: 1.2rem;
      }
      .fa-caret-right {
        width: 1.2rem;
        text-align: right;
      }
    }
    .menu-item-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      column-gap: 0.4rem;
      row-gap: 0.4rem;
      height: 3.8rem;
      .menu-style-btn {
        flex: 1;
        background-color: var(--bg-color-context-menu);
        border: 0.1rem solid var(--border-color);
        width: unset;
        margin: 0;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 3rem;
        &:hover {
          background-color: var(--bg-color-hover);
        }
        &.disabled {
          cursor: not-allowed;
          background-color: unset;
        }
      }
    }
  }
  .divider {
    opacity: 1;
    border-top: 0.1rem solid var(--border-color);
    margin: 0.4rem 0;
  }
}

.dropdown-menu.ext-context-menu {
  background-color: var(--bg-color-context-menu);
  border: 0.1rem solid var(--border-color);
  li {
    &.active {
      a {
        background-color: var(--bg-color-hover);
      }
    }
    a {
      padding: 0 2.4rem;
      font-size: 1.2rem;
      height: 3rem;
      line-height: 3rem;
      &:hover {
        cursor: pointer;
        background-color: var(--bg-color-hover);
      }
      span {
        line-height: 3rem;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        padding-right: 1.2rem;
      }
    }
  }
  .divider {
    opacity: 1;
    border-top: 0.1rem solid var(--border-color);
    margin: 0.4rem 0;
  }
}

#common-dialog.in {
  display: flex !important;
  align-items: center;
  justify-content: center;
  .modal-dialog {
    padding: 0;
    margin: 0;
    .modal-content {
      padding: 0;
      margin: 0;
      background-color: var(--bg-color-frame);
      border: 0.1rem solid var(--border-color);
      border-radius: 0.1rem;
      .modal-header {
        padding: 1.2rem;
      }
      .modal-body {
        padding: 0 1.2rem;
      }
      .modal-footer {
        padding: 1.2rem;
        font-weight: bold;
        .btn:first-child {
          background-color: var(--bg-color-primary);
          border: 0.1rem solid var(--border-color-primary);
          border-radius: 0.1rem;
          &:hover {
            opacity: 0.8;
          }
          &:focus,
          &:active {
            border: 0.1rem solid var(--border-color-primary);
            outline: none !important;
          }
        }
        .btn:nth-child(2) {
          background-color: var(--bg-color-frame);
          border: 0.1rem solid var(--border-color);
          border-radius: 0.1rem;
          margin-left: 0.8rem;
          &:hover {
            background-color: var(--bg-color-hover-window-close);
          }
          &:focus,
          &:active {
            border: 0.1rem solid var(--border-color) !important;
            outline: none !important;
          }
        }

        .btn:last-child {
          background-color: var(--bg-color-frame);
          border: 0.1rem solid var(--border-color);
          border-radius: 0.1rem;
          &:hover {
            background-color: var(--bg-color-hover);
          }
          &:focus,
          &:active {
            border: 0.1rem solid var(--border-color) !important;
            outline: none !important;
          }
        }
      }
    }
  }
}

#footer-word-count-info {
  background-color: var(--bg-color-frame);
  border: 0.1rem solid var(--border-color);
  border-bottom: none;
  border-radius: 0.2rem;
  right: 0.8rem;
  bottom: 3.2rem;
  margin: 0;
  padding: 0.4rem 0;
  li {
    font-size: 1.2rem;
    .footer-word-count-info-line {
      opacity: 1;
      display: block;
      padding: 0 1.2rem;
    }
    &.ty-footer-word-count-all {
      padding-top: 0 !important;
      tr {
        &:hover {
          cursor: pointer;
          background-color: var(--bg-color-hover) !important;
        }
      }
      #footer-read-time-count-td,
      #footer-line-count-td,
      #footer-word-count-td,
      #footer-char-count-td {
        padding: 0 1.2rem;
      }
    }
  }
  .divider {
    border-top: 0.1rem solid var(--border-color);
  }
}

.megamenu-opened {
  header {
    background-color: var(--bg-color-frame);
  }
  #megamenu-menu-sidebar {
    background-color: var(--bg-color-frame);
    border-right: 0.1rem solid var(--border-color);
    .megamenu-menu-header {
      height: 3.2rem;
      padding: 0 1.2rem;
      display: flex;
      align-items: center;
      border-bottom: 0.1rem solid var(--border-color);
      #megamenu-back-btn {
        position: relative !important;
        width: 2.4rem;
        height: 2.4rem;
        display: flex;
        align-items: center;
        justify-content: center;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border: none;
        &:hover {
          background-color: var(--bg-color-hover);
          border-radius: 0.1rem;
        }
        .ion-android-arrow-back {
          font-size: 1.2rem;
        }
      }
      #megamenu-menu-header-title {
        position: relative !important;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin-left: 0.4rem;
        font-size: 1.6rem;
      }
    }
    .megamenu-menu-list {
      margin: 0.4rem 0;
      li {
        font-size: 1.4rem;
        &.divider {
          margin: 0.4rem 0;
          border-top: 0.1rem solid var(--border-color);
        }
        a {
          display: flex;
          align-items: center;
          height: 3rem;
          padding: 0 1.2rem;
          &:hover {
            background-color: var(--bg-color-hover);
          }
          &.active {
            background-color: var(--bg-color-active);
          }
          &#m-saved {
            position: relative;
            i.fa {
              position: absolute;
              right: 1.2rem;
              top: 50%;
              transform: translateY(-50%);
              color: var(--color-primary);
            }
          }
        }
      }
    }
  }
  #megamenu-content {
    background-color: var(--bg-color-content);
    color: var(--color-white);
    top: 3.2rem;
    left: 0;
    right: 0;
    bottom: 0;
    padding-right: 0;
    padding-top: 0;
    &::-webkit-scrollbar {
      width: 0;
    }
    .megamenu-section {
      background-color: var(--bg-color-content);
      color: var(--color-white);
      min-height: 100%;
      // 打开
      &#megamenu-section-open {
        padding-bottom: 1.2rem;
        .megamenu-menu-panel {
          &:last-child {
            display: none;
          }
          h1,
          h2 {
            margin: 1.2rem 0;
            color: var(--color-primary);
          }
          #m-open-local,
          #m-import-local {
            color: var(--color-white);
            border: 0.1rem solid var(--border-color);
            background-color: var(--bg-color-frame);
            margin: 1.2rem 0;
            width: 100%;
            height: 4.8rem;
            display: flex;
            align-items: center;
            &:hover {
              border: 0.1rem solid var(--border-color-primary);
              background-color: var(--bg-color-hover);
              * {
                color: var(--color-primary);
              }
            }
            i {
              margin-right: 0.8rem;
              flex-shrink: 0;
            }
            > span {
              flex: 1;
            }
          }
          #recent-file-panel {
            position: relative;
            #recent-file-panel-search-input {
              height: 4.8rem;
              display: flex;
              align-items: center;
              width: calc(100% - 8rem);
              border: 0.1rem solid var(--border-color);
              background: transparent;
              font-size: 1.8rem;
              color: var(--color-white);
              &:focus {
                border-color: var(--color-primary);
              }
            }
            #recent-file-panel-action-btn-container {
              width: 7.2rem;
              height: 4.8rem;
              background-color: var(--bg-color-frame);
              margin: 0;
              position: absolute;
              right: 0;
              top: 0;
              border: 0.1rem solid var(--border-color);
              &:hover {
                background-color: var(--bg-color-hover);
              }
              #recent-file-panel-action-btn {
                background-color: transparent;
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                border: none;
                &:focus,
                &:active {
                  outline: none !important;
                }
                &:active {
                  i.fa {
                    color: var(--color-primary);
                  }
                }
                i.fa {
                  color: var(--color-white);
                  font-size: 2.4rem;
                }
              }
              .dropdown-menu {
                right: 0;
                margin: 0;
                top: unset !important;
                bottom: 0;
                transform: translateY(calc(100% + 0.4rem));
                li {
                  height: 3.6rem;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  background-color: var(--bg-color-frame);
                  border: 0.1rem solid var(--border-color);
                  border-radius: 0.1rem;
                  &:hover {
                    background-color: var(--bg-color-hover);
                  }
                  a {
                    color: var(--color-white);
                    background-color: transparent;
                    &:hover {
                      background-color: transparent;
                    }
                  }
                }
              }
            }
            #recent-document-table {
              background-color: var(--bg-color-frame);
              margin: 1.2rem 0;
              thead {
                tr {
                  color: var(--color-primary);
                  &:hover {
                    cursor: default !important;
                    background-color: transparent !important;
                  }
                }
              }
              tr {
                background-color: var(--bg-color-frame);
                border: 0.1rem solid var(--border-color);
                color: var(--color-white);
                &:hover {
                  background-color: var(--bg-color-hover) !important;
                  color: var(--color-primary);
                }
              }
            }
          }
        }
      }
      // 导出
      &#megamenu-section-export {
        .megamenu-menu-panel {
          h1 {
            margin: 1.2rem 0;
            color: var(--color-primary);
          }
          .long-btn-wrap {
            display: flex;
            align-items: center;
            column-gap: 1.2rem;
            row-gap: 1.2rem;
            margin: 1.2rem 0;
            flex-wrap: wrap;
            .long-btn {
              width: calc(50% - 0.6rem);
              margin: 0;
              border-radius: 0.2rem;
              color: var(--color-white);
              border: 0.1rem solid var(--border-color);
              display: flex;
              align-items: center;
              height: 4.8rem;
              flex-shrink: 0;
              background-color: var(--bg-color-frame);
              &:hover {
                border: 0.1rem solid var(--border-color-primary);
                background-color: var(--bg-color-hover);
                * {
                  color: var(--color-primary);
                }
              }
              i.fa {
                margin-right: 0.8rem;
                flex-shrink: 0;
              }
              span {
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                display: block;
              }
            }
          }
          .preference-item-hint {
            margin: 1.2rem 0 !important;
          }
        }
      }
      // 主题
      &#megamenu-section-theme {
        .megamenu-menu-panel {
          h1 {
            color: var(--color-primary);
            margin: 1.2rem 0;
          }
          #theme-preview-grid {
            max-width: unset;
            display: flex;
            flex-direction: column;
            row-gap: 1.2rem;
            .theme-preview-div {
              margin: 0;
              border-radius: 0.2rem;
              border-width: 0.1rem;
              display: block;
              overflow: hidden;
              border: 0.1rem solid var(--border-color);
              height: 9.6rem;
              &:hover {
                cursor: pointer;
                border: 0.1rem solid var(--border-color-primary);
              }
              &.active {
                border: 0.1rem solid var(--border-color-primary);
              }
              .theme-preview-content {
                width: 100%;
                height: 100%;
                height: 100%;
              }
              .fa.fa-check-circle {
                color: var(--color-primary);
                right: 0.8rem;
                bottom: 0.8rem;
                left: unset;
              }
            }
          }
          #open-theme-folder-btn {
            width: 100%;
            padding: 0;
            margin: 0;
            background-color: transparent;
            border-color: var(--border-color);
            color: var(--color-white);
            border-radius: 0.2rem;
            text-align: center;
            margin: 1.2rem 0;
            height: 4.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color-frame);
            &:hover {
              border-color: var(--border-color-primary);
              background-color: var(--bg-color-hover);
              span {
                color: var(--color-primary);
              }
            }
          }
        }
      }
      // 关于
      &#megamenu-section-about {
        .megamenu-menu-content-section {
          margin-bottom: 2.4rem;
          h1 {
            color: var(--color-primary);
          }
          &#about-content-about-section {
            .about-content-main {
              text-align: unset;
              padding: 0;
              margin: 0;
              max-width: 100%;
              .about-content-icon {
                margin-left: 0;
                margin-right: 0;
                img {
                  border: none;
                }
              }
            }
          }
        }
        #about-content-license-button {
          margin: 1.2rem 0;
          border: 0.1rem solid var(--border-color);
          background-color: var(--bg-color-frame);
          border-radius: 0.2rem;
          font-size: 1.4rem;
          height: 4.8rem;
          width: 100%;
          &:hover {
            color: var(--color-primary);
            border-color: var(--color-primary);
          }
        }
        tr:hover {
          background-color: var(--bg-color-hover) !important;
        }
      }
      .megamenu-menu-panel {
        margin: 0;
        padding: 0 1.2rem;
      }
    }
  }
}

// 表格
figure.md-table-fig {
  margin: 0;
  padding: 0;
  .ty-table-edit {
    width: 100% !important;
    position: relative;
    margin: 0 !important;
    padding: 0.4rem !important;
    position: relative;
    background-color: var(--bg-color-frame);
    border: 0.1rem solid var(--border-color);
    border-bottom: none;
    display: flex;
    align-items: center;
    span {
      &.md-resize-table-th {
        display: none !important;
      }
      &.btn-group {
        padding: 0;
        flex: 1;
        .md-align-left {
          border-right: 0;
        }
        .md-align-right {
          border-left: none;
        }
      }
      .md-delete-table {
        margin-right: 0.4rem !important;
      }
      .md-table-more {
        .md-table-more-label {
          display: none !important;
        }
        .ty-icon {
          margin: 0 !important;
          padding: 0 !important;
        }
      }
      button {
        border: 0.1rem solid var(--border-color);
        border-radius: 0.1rem;
        width: 2.4rem;
        height: 2.4rem;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
        margin: 0 !important;
        line-height: unset !important;
        &:hover {
          background-color: var(--bg-color-hover);
        }
        &.active {
          background-color: var(--bg-color-active);
        }
      }
    }
  }
  table.md-table {
    background-color: var(--bg-color-frame);
    border: 0.1rem solid var(--border-color);
    margin: 0;
    padding: 0;
    thead {
      tr {
        th {
          border: 0.1rem solid var(--border-color);
          padding: 0.4rem 0.8rem;
        }
      }
    }
    tbody {
      tr {
        td {
          border: 0.1rem solid var(--border-color);
          padding: 0.4rem 0.8rem;
        }
      }
    }
  }
}

// 插入表格弹窗
#table-insert-dialog.in {
  display: flex !important;
  align-items: center;
  justify-content: center;
  .modal-dialog {
    margin: 0;
    width: unset;
    .modal-content {
      margin: 0;
      background-color: var(--bg-color-frame);
      border-radius: 0.2rem;
      .modal-header {
        padding: 1.2rem;
        min-height: unset;
      }
      .modal-body {
        padding: 1.2rem;
        .row {
          display: flex;
          align-items: center;
          column-gap: 1.2rem;
          .col-lg-6 {
            flex: 1;
            flex-shrink: 0;
            width: unset !important;
            margin: 0;
            .input-group {
              .form-control {
                width: unset !important;
                border-radius: 0.1rem;
                &:focus {
                  border-color: var(--border-color-primary);
                  padding: 0 0.8rem;
                  box-shadow: unset !important;
                }
              }
            }
          }
        }
      }
      .modal-footer {
        .btn {
          width: 4.8rem;
          height: 3.2rem;
          &.btn-primary {
            background-color: var(--bg-color-primary);
            &:hover {
              opacity: 0.8;
            }
          }
        }
      }
    }
  }
}

// 图片默认靠左
p>.md-image:only-child {
  width: auto;
}
